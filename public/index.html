<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shadow VM Launcher</title>
  <style>
    body { background: #000; color: #fff; font-family: sans-serif; margin: 0; padding: 20px; }
    input, select, button { margin: 5px; padding: 5px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>Start Shadow VM</h2>
  <input id="apiKey" type="password" placeholder="Enter Hyperbeam API Key" />
  <select id="region">
    <option value="us-east">US East</option>
    <option value="us-west">US West</option>
    <option value="eu-west">EU West</option>
    <option value="ap-southeast">Asia Pacific</option>
  </select>
  <button id="start">Start VM</button>

  <div id="output" style="margin-top:20px;"></div>

  <script type="module">
    document.getElementById("start").addEventListener("click", async () => {
      const apiKey = document.getElementById("apiKey").value.trim();
      const area = document.getElementById("region").value;
      const output = document.getElementById("output");
      output.innerText = "üöÄ Creating VM...";

      if (!apiKey) {
        alert("Please enter your API key.");
        return;
      }

      try {
        const resp = await fetch("/api/create-vm", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ apiKey, area }),
        });

        const data = await resp.json();
        console.log("VM data:", data);

        if (!data.embed_url) {
          output.innerText = "‚ùå Failed to create VM. Check server logs.";
          return;
        }

        output.innerHTML = `‚úÖ VM ready! <a href="${data.embed_url}" target="_blank">Open VM</a>`;
      } catch (err) {
        console.error(err);
        output.innerText = "‚ùå Error creating VM. Check console for details.";
      }
    });
  </script>
</body>
</html>
